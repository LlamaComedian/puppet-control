classes:
  - 'elastic'
  - 'ha'
  - firewallservice

ha::virtual_ip: 192.168.42.10
ha::interface: eth1
ha::lb_instances:
  default:
    port: 9201
    healthcheck: /_cluster/health
    backends:
      - 192.168.42.11:9200
      - 192.168.42.12:9200

elastic::version: "5.3.0"
elastic::java_package: "java-1.8.0-openjdk"
elastic::cluster_name: "test-cluster"
elastic::cluster_servers: ['192.168.42.11', '192.168.42.12']
elastic::els_minimum_nodes: 2
elastic::hosts:
  server1: 192.168.42.11
  server2: 192.168.42.12

firewallservice::ensure: running

firewallservice::rules:
  '200 Allow HTTP access on port 9201 from 192.168.42.21':
    port: '9201' # vip port
    proto: tcp
    action: accept
    source: '192.168.42.21' # ip address of kibana server
  '201 Allow HTTP access on port 9201 from 192.168.42.22':
    port: '9201' # vip port
    proto: tcp
    action: accept
    source: '192.168.42.22' # ip address of kibana server
  '202 Allow HTTP access on port 9200 from 192.168.42.51':
    port: '9200' # port of elasticsearch
    proto: tcp
    action: accept
    source: '192.168.42.51' # ip address of log consumer
  '203 Allow HTTP access on port 9200 from 192.168.42.52':
    port: '9200' # port of elasticsearch
    proto: tcp
    action: accept
    source: '192.168.42.52' # ip address of log consumer
  '204 Allow all access from 192.168.42.11':
    proto: all
    action: accept
    source: '192.168.42.11' # ip address of elasticsearch
  '205 Allow all access from 192.168.42.12':
    proto: all
    action: accept
    source: '192.168.42.12' # ip address of elasticsearch
