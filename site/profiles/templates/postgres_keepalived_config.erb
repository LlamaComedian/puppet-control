<% case @hostname
   when "nodea"
     server_priority = 100
   when "nodeb"
     server_priority = 99
   when "nodec"
     server_priority = 98
end %>
vrrp_script postgresql-9.4 {
  script "pgrep postgres"
  interval 2
  wait 2
}
vrrp_instance PG-CLUSTER {
    state MASTER
    interface eth1
    virtual_router_id 100
    priority <%= server_priority %>
    advert_int 1
    virtual_ipaddress {
        192.168.33.100
    }
    track_script {
      postgresql-9.4
    }
}
vrrp_script haproxy {
  script "pgrep haproxy"
  interval 2
  wait 2
}
vrrp_instance HAPROXY-CLUSTER {
    state MASTER
    interface eth1
    virtual_router_id 101
    priority 100
    advert_int 1
    virtual_ipaddress {
        192.168.33.101
    }
    track_script {
      haproxy
    }
}
